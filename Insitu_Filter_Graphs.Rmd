---
title: "Insitu_Filter Graphs"
author: "Althea Marks"
date: "11/12/2019"
output: html_document
---

```{r}
library(ggplot2)

# Graph Color Palette: Color blind palette with black:
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

Basic Analysis Graphs
```{r}

# FR vs TPM (Filtration Trials only)
(FR_TPM_graph <- ggplot(Master_analysis_table %>% 
                          filter(Experiment == "Filtration"), 
                        aes(Avg_TPM, L_hr_m2, color = Site)) +
  geom_point() +
  theme_classic() +
  labs(x = 'Total Particulate Matter (ug/L)',
       y = 'Clearence Rate (L/hr/m^2)',
       title = 'All Filtration Trials') +
  guides(fill = FALSE))

# Fit line 
(FR_TPM_graph_best_line <- ggplot(Master_analysis_table %>% 
                                      filter(Experiment == "Filtration"), 
                                    aes(Avg_TPM, L_hr_m2)) +
  geom_point() +
  geom_smooth() +
  theme_classic() +
  labs(x = 'Total Particulate Matter (ug/L)',
       y = 'Clearence Rate (L/hr/m^2)',
       title = 'All Filtration Trials with best fit line') +
  guides(fill = FALSE))
```


```{r}
(FR_OC_graph <- ggplot(Master_analysis_table %>% 
                          filter(Experiment == "Filtration"), 
                        aes(Avg_OC_Ratio, L_hr_m2, color = Site)) +
  geom_point() +
  theme_classic() +
  labs(x = 'Organic Content of Seston (fraction)',
       y = 'Clearence Rate (L/hr/m^2)',
       title = 'All Filtration Trials') +
  guides(fill = FALSE))

```

```{r}

TPM_OC_base <- ggplot(data = Avg_TPM_summary_table, aes(x = Avg_TPM, y = Avg_OC_Ratio, color = Site, label = Date))

TPM_OC_base + geom_point(size=4) + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.007, nudge_y = 0, check_overlap = T)


#+ geom_label(data = Avg_TPM_summary_table, aes(label = Date))



```

```{r}

exclude_low_deanza <- ggplot(data = (Avg_TPM_summary_table %>% filter(!(Site == "Deanza") | !(Date == "4/18/19"))), aes(x = Avg_TPM, y = Avg_OC_Ratio, color = Site, label = Date))

exclude_low_deanza + geom_point(size=4) + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC", subtitle = "Excluding NPD 4/18/19") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.007, nudge_y = 0, check_overlap = T)
```
Plot individual Sites TPM vs OC
```{r}
############ Deanza #############
Deanza_only <- ggplot(data = (Avg_TPM_summary_table %>% filter(Site == "Deanza")), aes(x = Avg_TPM, y = Avg_OC_Ratio, label = Date))

Deanza_only + geom_point(size=4, color = '#F8766D') + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC Deanza") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.0003, nudge_y = 0, check_overlap = T)

############ Shellmaker ##########
Shellmaker_only <- ggplot(data = (Avg_TPM_summary_table %>% filter(Site == "Shellmaker")), aes(x = Avg_TPM, y = Avg_OC_Ratio, label = Date))

Shellmaker_only + geom_point(size=4, color = '#C77CFF') + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC Shellmaker") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.0002, nudge_y = 0, check_overlap = T)

############ San Rafael ##########
SR_only <- ggplot(data = (Avg_TPM_summary_table %>% filter(Site == "San Rafael")), aes(x = Avg_TPM, y = Avg_OC_Ratio, label = Date))

SR_only + geom_point(size=4, color = '#00BFC4') + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC San Rafael") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.005, nudge_y = 0, check_overlap = T)

############ Morro Bay ##########
MB_only <- ggplot(data = (Avg_TPM_summary_table %>% filter(Site == "Morro Bay")), aes(x = Avg_TPM, y = Avg_OC_Ratio, label = Date))

MB_only + geom_point(size=4, color = '#7CAE00') + 
  labs(x = "Total Particulate Matter", y = "Average Organic Content Ratio", title = "TPM --> OC Morr Bay") + 
  theme_classic() +
  geom_text(aes(label=Date), nudge_x = 0.0005, nudge_y = 0, check_overlap = T)
```
